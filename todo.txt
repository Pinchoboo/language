1. use realloc
2. void in mapstruct and perfectmap
3. make the 3 state enum not use 64 bits